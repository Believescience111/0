// ==UserScript==
// @name         中国大学MOOC挂机
// @namespace    https://github.com/CodFrm/cxmooc-tools
// @version 2.4.0
// @description  一个中国大学mooc刷课工具,火狐,谷歌,油猴支持.支持自动观看视频/课件/讨论,屏蔽视频题目和静音倍速,作业/测试题库,考试题库,SCOP课程(੧ᐛ੭挂科模式,启动)
// @author       CodFrm
// @run-at       document-start
// @match        *://www.icourse163.org/learn/*
// @match        *://www.icourse163.org/spoc/learn/*
// @grant        GM_xmlhttpRequest
// @grant        GM_notification
// @grant        unsafeWindow
// @license      MIT
// ==/UserScript==

let config = {
    answer_ignore: true, //忽略题目,勾选此处将不会答题
    auto: true, //全自动挂机,无需手动操作,即可自动观看视频等
    rand_answer: false, //随机答案,没有答案的题目将自动的生成一个答案
    interval: 1, //时间间隔,当任务点完成后,会等待1分钟然后跳转到下一个任务点
    video_multiple: 1, //视频播放倍速,视频播放的倍数,建议不要改动,为1即可,这是危险的功能
    video_mute: true, //视频静音,视频自动静音播放
    vtoken: "",
};

Object.keys(config).forEach(k => {
    localStorage[k] = config[k];
});
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/tampermonkey/course163-pack.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/config.ts":
/*!***********************!*\
  !*** ./src/config.ts ***!
  \***********************/
/*! exports provided: SystemConfig */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SystemConfig\", function() { return SystemConfig; });\nvar SystemConfig = /** @class */ (function () {\r\n    function SystemConfig() {\r\n    }\r\n    SystemConfig.version = 2.4;\r\n    SystemConfig.url = \"https://cxmooc.wget.es/\";\r\n    SystemConfig.hotVersion = \"2.4.0\";\r\n    SystemConfig.match = [\r\n        \"*://*/mycourse/studentstudy?*\",\r\n        \"*://*/work/doHomeWorkNew?*\",\r\n        \"*://*/work/selectWorkQuestionYiPiYue?*\",\r\n        \"*://*/exam/test/reVersionTestStartNew?*\",\r\n        \"*://*/ztnodedetailcontroller/visitnodedetail?*\",\r\n        \"*://*/antispiderShowVerify.ac*\",\r\n        \"*://*/html/processVerify.ac?*\",\r\n        \"*://*/exam/test/reVersionPaperMarkContentNew?*\",\r\n        \"*://*/ananas/modules/*/index.html?*\",\r\n        \"*://*/exam/test?*\",\r\n        \"*://*/course/*.html?*\",\r\n        \"*://examh5.zhihuishu.com/stuExamWeb.html*\",\r\n        \"*://onlineexamh5new.zhihuishu.com/stuExamWeb.html*\",\r\n        \"*://studyh5.zhihuishu.com/videoStudy.html*\",\r\n        \"*://www.icourse163.org/learn/*\",\r\n        \"*://www.icourse163.org/spoc/learn/*\"\r\n    ];\r\n    return SystemConfig;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/config.ts?");

/***/ }),

/***/ "./src/internal/app/question.ts":
/*!**************************************!*\
  !*** ./src/internal/app/question.ts ***!
  \**************************************/
/*! exports provided: PushAnswer, TopicStatusString, QuestionStatusString, SwitchTopicType, ToolsQuestionBank, ToolsQuestionBankFacade */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PushAnswer\", function() { return PushAnswer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TopicStatusString\", function() { return TopicStatusString; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"QuestionStatusString\", function() { return QuestionStatusString; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SwitchTopicType\", function() { return SwitchTopicType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ToolsQuestionBank\", function() { return ToolsQuestionBank; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ToolsQuestionBankFacade\", function() { return ToolsQuestionBankFacade; });\n/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/utils */ \"./src/internal/utils/utils.ts\");\n/* harmony import */ var _App_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @App/config */ \"./src/config.ts\");\n/* harmony import */ var _application__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../application */ \"./src/internal/application.ts\");\n\r\n\r\n\r\nvar PushAnswer = /** @class */ (function () {\r\n    function PushAnswer() {\r\n    }\r\n    PushAnswer.prototype.Equal = function (content1, content2) {\r\n        return content1 == content2;\r\n    };\r\n    return PushAnswer;\r\n}());\r\n\r\nvar topicStatusMap = new Map();\r\ntopicStatusMap.set(\"ok\", \"搜索成功\").set(\"random\", \"随机答案\").set(\"no_support_random\", \"不支持的随机答案类型\").set(\"no_answer\", \"题库中没有搜索到答案\").set(\"no_match\", \"题库中没有符合的答案\");\r\nvar questionStatusMap = new Map();\r\nquestionStatusMap.set(\"success\", \"搜索成功\").set(\"network\", \"题库网络错误\").set(\"incomplete\", \"题库不全\").set(\"processing\", \"搜索中...\");\r\nfunction TopicStatusString(status) {\r\n    return topicStatusMap.get(status) || \"未知错误\";\r\n}\r\nfunction QuestionStatusString(status) {\r\n    return questionStatusMap.get(status) || \"未知错误\";\r\n}\r\nfunction SwitchTopicType(title) {\r\n    switch (title) {\r\n        case \"单选题\": {\r\n            return 1;\r\n        }\r\n        case \"多选题\": {\r\n            return 2;\r\n        }\r\n        case \"判断题\": {\r\n            return 3;\r\n        }\r\n        case \"填空题\": {\r\n            return 4;\r\n        }\r\n        default: {\r\n            return null;\r\n        }\r\n    }\r\n}\r\n// 小工具题库\r\nvar ToolsQuestionBank = /** @class */ (function () {\r\n    function ToolsQuestionBank(platform, info) {\r\n        this.platform = platform;\r\n        this.info = info;\r\n    }\r\n    ToolsQuestionBank.prototype.SetInfo = function (info) {\r\n        this.info = info;\r\n    };\r\n    ToolsQuestionBank.prototype.GetInfo = function () {\r\n        return encodeURIComponent(JSON.stringify(this.info));\r\n    };\r\n    ToolsQuestionBank.prototype.Answer = function (topic, resolve) {\r\n        var _this = this;\r\n        _application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.log.Debug(\"答案查询\", topic);\r\n        var num = 10;\r\n        var answer = new Array();\r\n        var retStatus = \"success\";\r\n        var next = function (index) {\r\n            var body = \"info=\" + _this.GetInfo() + \"&\";\r\n            var t = index;\r\n            for (; t < index + num && t < topic.length; t++) {\r\n                var val = topic[t];\r\n                body += \"topic[\" + (t - index) + \"]=\" + encodeURIComponent((val.topic)) + \"&type[\" + (t - index) + \"]=\" + val.type + \"&\";\r\n            }\r\n            _utils_utils__WEBPACK_IMPORTED_MODULE_0__[\"HttpUtils\"].HttpPost(_App_config__WEBPACK_IMPORTED_MODULE_1__[\"SystemConfig\"].url + \"v2/answer?platform=\" + _this.platform, body, {\r\n                json: true,\r\n                success: function (result) {\r\n                    var status = \"success\";\r\n                    var tmpResult = new Array();\r\n                    for (var i = 0; i < result.length; i++) {\r\n                        if (result[i].result == undefined || result[i].result.length <= 0) {\r\n                            tmpResult.push({\r\n                                index: index + result[i].index,\r\n                                topic: result[i].topic,\r\n                                type: -1,\r\n                                status: \"no_answer\",\r\n                                answers: null,\r\n                                correct: null,\r\n                                Equal: _this.Equal,\r\n                            });\r\n                            status = \"incomplete\";\r\n                            continue;\r\n                        }\r\n                        var val = result[i].result[0];\r\n                        tmpResult.push({\r\n                            index: index + result[i].index,\r\n                            topic: val.topic,\r\n                            type: val.type,\r\n                            correct: val.correct,\r\n                            status: \"ok\",\r\n                            Equal: _this.Equal,\r\n                        });\r\n                    }\r\n                    answer = answer.concat(tmpResult);\r\n                    if (status != \"success\") {\r\n                        retStatus = status;\r\n                    }\r\n                    resolve({ status: \"processing\", answer: tmpResult });\r\n                    if (t < topic.length) {\r\n                        next(t);\r\n                    }\r\n                    else {\r\n                        return resolve({ status: retStatus, answer: answer });\r\n                    }\r\n                },\r\n                error: function () {\r\n                    return resolve({ status: \"network\", answer: answer });\r\n                }\r\n            });\r\n        };\r\n        next(0);\r\n    };\r\n    ToolsQuestionBank.prototype.Push = function (answer) {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.log.Debug(\"采集提交\", answer);\r\n            _utils_utils__WEBPACK_IMPORTED_MODULE_0__[\"HttpUtils\"].HttpPost(_App_config__WEBPACK_IMPORTED_MODULE_1__[\"SystemConfig\"].url + \"answer?platform=\" + _this.platform, \"info=\" + _this.GetInfo() + \"&data=\" + encodeURIComponent(JSON.stringify(answer)), {\r\n                json: true,\r\n                success: function (result) {\r\n                    _application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.log.Info(\"答案自动记录成功,成功获得\" + result.add_token_num + \"个打码数,剩余数量:\" + result.token_num);\r\n                    resolve(\"success\");\r\n                },\r\n                error: function () {\r\n                    resolve(\"network\");\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ToolsQuestionBank.prototype.Equal = function (content1, content2) {\r\n        return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_0__[\"removeHTML\"])(content1) == Object(_utils_utils__WEBPACK_IMPORTED_MODULE_0__[\"removeHTML\"])(content2);\r\n    };\r\n    ToolsQuestionBank.prototype.CheckCourse = function (info) {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            info = info || [_this.info];\r\n            _utils_utils__WEBPACK_IMPORTED_MODULE_0__[\"HttpUtils\"].HttpPost(_App_config__WEBPACK_IMPORTED_MODULE_1__[\"SystemConfig\"].url + \"v2/check?platform=\" + _this.platform, \"info=\" + encodeURIComponent(JSON.stringify(info)), {\r\n                success: function () {\r\n                    //TODO:课程题目数量\r\n                    resolve(0);\r\n                }, error: function () {\r\n                    resolve(-1);\r\n                }\r\n            });\r\n            resolve();\r\n        });\r\n    };\r\n    return ToolsQuestionBank;\r\n}());\r\n\r\nvar ToolsQuestionBankFacade = /** @class */ (function () {\r\n    function ToolsQuestionBankFacade(platform, info) {\r\n        if (typeof platform == \"string\") {\r\n            this.bank = new ToolsQuestionBank(platform, info);\r\n        }\r\n        else {\r\n            this.bank = platform;\r\n        }\r\n        this.question = new Array();\r\n    }\r\n    ToolsQuestionBankFacade.prototype.ClearQuestion = function () {\r\n        this.question = new Array();\r\n    };\r\n    ToolsQuestionBankFacade.prototype.AddQuestion = function (q) {\r\n        this.question.push(q);\r\n    };\r\n    ToolsQuestionBankFacade.prototype.Answer = function (callback) {\r\n        var _this = this;\r\n        var topic = new Array();\r\n        this.question.forEach(function (val) {\r\n            var type = val.GetType();\r\n            if (type == -1) {\r\n                return;\r\n            }\r\n            topic.push({\r\n                topic: (val.GetTopic()),\r\n                type: type,\r\n            });\r\n        });\r\n        var status = \"success\";\r\n        this.bank.Answer(topic, function (ret) {\r\n            if (ret.status != \"processing\") {\r\n                _application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.log.Debug(\"题库返回\", ret);\r\n                if (ret.status != \"success\" || status == \"success\") {\r\n                    return callback(ret.status);\r\n                }\r\n                return callback(status);\r\n            }\r\n            for (var i = 0; i < ret.answer.length; i++) {\r\n                var answer = ret.answer[i];\r\n                var question = _this.question[answer.index];\r\n                var tmpStatus = answer.status;\r\n                if (answer.status == \"no_answer\") {\r\n                    status = _this.randAnswer(status, tmpStatus, question);\r\n                    continue;\r\n                }\r\n                if (answer.type != question.GetType()) {\r\n                    tmpStatus = \"no_match\";\r\n                }\r\n                else {\r\n                    tmpStatus = question.Fill(answer);\r\n                }\r\n                if (tmpStatus == \"no_match\") {\r\n                    status = _this.randAnswer(status, tmpStatus, question);\r\n                    continue;\r\n                }\r\n                question.SetStatus(tmpStatus);\r\n            }\r\n        });\r\n    };\r\n    ToolsQuestionBankFacade.prototype.randAnswer = function (status, tmpStatus, question) {\r\n        if (_application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.config.rand_answer) {\r\n            tmpStatus = question.Random();\r\n        }\r\n        else {\r\n            status = \"incomplete\";\r\n        }\r\n        if (tmpStatus == \"no_support_random\") {\r\n            status = \"incomplete\";\r\n        }\r\n        question.SetStatus(tmpStatus);\r\n        return status;\r\n    };\r\n    ToolsQuestionBankFacade.prototype.Push = function (callback) {\r\n        var answer = new Array();\r\n        this.question.forEach(function (val) {\r\n            var correct = val.Correct();\r\n            if (correct == null || correct.correct == null || correct.type == -1) {\r\n                return;\r\n            }\r\n            correct.topic = correct.topic;\r\n            correct.answers = correct.answers;\r\n            correct.correct = correct.correct;\r\n            answer.push(correct);\r\n        });\r\n        this.bank.Push(answer).then(function (ret) {\r\n            _application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.log.Debug(\"题库返回\", ret);\r\n            return callback(ret);\r\n        });\r\n    };\r\n    ToolsQuestionBankFacade.prototype.dealOption = function (options) {\r\n        for (var i = 0; i < options.length; i++) {\r\n            if (typeof options[i].content == \"string\") {\r\n                options[i].content = (options[i].content);\r\n            }\r\n        }\r\n        return options;\r\n    };\r\n    ToolsQuestionBankFacade.prototype.CheckCourse = function () {\r\n        return this.bank.CheckCourse();\r\n    };\r\n    return ToolsQuestionBankFacade;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/internal/app/question.ts?");

/***/ }),

/***/ "./src/internal/app/task.ts":
/*!**********************************!*\
  !*** ./src/internal/app/task.ts ***!
  \**********************************/
/*! exports provided: Task */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Task\", function() { return Task; });\nvar Task = /** @class */ (function () {\r\n    function Task() {\r\n        this.event = {};\r\n    }\r\n    Task.prototype.addEventListener = function (event, callback) {\r\n        if (!this.event[event]) {\r\n            this.event[event] = new Array();\r\n        }\r\n        this.event[event].push(callback);\r\n    };\r\n    Task.prototype.callEvent = function (event) {\r\n        if (!this.event[event]) {\r\n            return;\r\n        }\r\n        this.event[event].forEach(function (v) {\r\n            v();\r\n        });\r\n    };\r\n    Task.prototype.Init = function () {\r\n        return new Promise(function (resolve) {\r\n            return resolve();\r\n        });\r\n    };\r\n    Task.prototype.Done = function () {\r\n        return false;\r\n    };\r\n    Task.prototype.Submit = function () {\r\n        return new Promise(function (resolve) {\r\n            return resolve();\r\n        });\r\n    };\r\n    Task.prototype.Stop = function () {\r\n        return new Promise(function (resolve) {\r\n            return resolve();\r\n        });\r\n    };\r\n    return Task;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/internal/app/task.ts?");

/***/ }),

/***/ "./src/internal/app/topic.ts":
/*!***********************************!*\
  !*** ./src/internal/app/topic.ts ***!
  \***********************************/
/*! exports provided: Topic */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Topic\", function() { return Topic; });\n/* harmony import */ var _application__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../application */ \"./src/internal/application.ts\");\n/* harmony import */ var _App_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @App/config */ \"./src/config.ts\");\n\r\n\r\nvar Topic = /** @class */ (function () {\r\n    function Topic(content, answer) {\r\n        this.answer = answer;\r\n        this.context = content;\r\n    }\r\n    Topic.prototype.SetQueryQuestions = function (queryQuestions) {\r\n        this.queryQuestions = queryQuestions;\r\n    };\r\n    Topic.prototype.addQuestion = function () {\r\n        var _this = this;\r\n        var questions = this.queryQuestions.QueryQuestions();\r\n        this.answer.ClearQuestion();\r\n        questions.forEach(function (val) {\r\n            _this.answer.AddQuestion(val);\r\n        });\r\n    };\r\n    Topic.prototype.QueryAnswer = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            if (_this.lock) {\r\n                return resolve(\"processing\");\r\n            }\r\n            _this.lock = true;\r\n            _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Info(\"题目搜索中...\");\r\n            _this.addQuestion();\r\n            _this.answer.Answer(function (status) {\r\n                _this.lock = false;\r\n                resolve(status);\r\n                if (status == \"network\") {\r\n                    return _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Error(\"题库无法访问,请查看:\" + _App_config__WEBPACK_IMPORTED_MODULE_1__[\"SystemConfig\"].url);\r\n                }\r\n                else if (status == \"incomplete\") {\r\n                    return _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Warn(\"题库答案不全,请手动填写操作\");\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Topic.prototype.CollectAnswer = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Debug(\"收集题目答案\", _this.context);\r\n            _this.addQuestion();\r\n            _this.answer.Push(function (status) {\r\n                _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Debug(\"采集答案返回\", status);\r\n                resolve();\r\n            });\r\n        });\r\n    };\r\n    return Topic;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/internal/app/topic.ts?");

/***/ }),

/***/ "./src/internal/application.ts":
/*!*************************************!*\
  !*** ./src/internal/application.ts ***!
  \*************************************/
/*! exports provided: Backend, Frontend, Content, AppName, Application */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Backend\", function() { return Backend; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Frontend\", function() { return Frontend; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Content\", function() { return Content; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AppName\", function() { return AppName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Application\", function() { return Application; });\n/* harmony import */ var _utils_message__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/message */ \"./src/internal/utils/message.ts\");\n/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/utils */ \"./src/internal/utils/utils.ts\");\n/* harmony import */ var _App_config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @App/config */ \"./src/config.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\n\r\n\r\nvar Backend = \"backend\";\r\nvar Frontend = \"frontend\";\r\nvar Content = \"content\";\r\nvar AppName = \"cxmooc-tools\";\r\nvar Application = /** @class */ (function () {\r\n    function Application(runEnv, launcher, component) {\r\n        Application.app = this;\r\n        Application.runEnv = runEnv;\r\n        this.runEnvSwitch(runEnv);\r\n        this.launcher = launcher;\r\n        this.component = component;\r\n    }\r\n    Object.defineProperty(Application, \"App\", {\r\n        get: function () {\r\n            return Application.app;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Application.prototype, \"debug\", {\r\n        get: function () {\r\n            return \"development\" == \"development\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Application.prototype, \"prod\", {\r\n        get: function () {\r\n            return \"development\" == \"production\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Application.prototype, \"config\", {\r\n        get: function () {\r\n            return this.component.get(\"config\");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Application.prototype, \"log\", {\r\n        get: function () {\r\n            return this.component.get(\"logger\");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Application.prototype.run = function () {\r\n        this.launcher.start();\r\n    };\r\n    Object.defineProperty(Application.prototype, \"IsFrontend\", {\r\n        get: function () {\r\n            return Application.IsFrontend;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Application.prototype, \"IsBackend\", {\r\n        get: function () {\r\n            return Application.IsBackend;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Application.prototype, \"IsContent\", {\r\n        get: function () {\r\n            return Application.IsContent;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Application.prototype.runEnvSwitch = function (env) {\r\n        switch (env) {\r\n            case Frontend:\r\n                Application.IsFrontend = true;\r\n                break;\r\n            case Backend:\r\n                Application.IsBackend = true;\r\n                break;\r\n            case Content:\r\n                Application.IsContent = true;\r\n                break;\r\n        }\r\n        ;\r\n    };\r\n    Object.defineProperty(Application.prototype, \"Client\", {\r\n        get: function () {\r\n            if (Application.IsFrontend) {\r\n                return Object(_utils_message__WEBPACK_IMPORTED_MODULE_0__[\"NewChromeClientMessage\"])(AppName);\r\n            }\r\n            return Object(_utils_message__WEBPACK_IMPORTED_MODULE_0__[\"NewExtensionClientMessage\"])(AppName);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Application.CheckUpdate = function (callback) {\r\n        if (Application.IsContent) {\r\n            chrome.storage.local.get([\"version\", \"enforce\", \"hotversion\", \"url\"], function (item) {\r\n                return __awaiter(this, void 0, void 0, function () {\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0: return [4 /*yield*/, callback((_App_config__WEBPACK_IMPORTED_MODULE_2__[\"SystemConfig\"].version < item.version), item)];\r\n                            case 1:\r\n                                _a.sent();\r\n                                return [2 /*return*/];\r\n                        }\r\n                    });\r\n                });\r\n            });\r\n            return;\r\n        }\r\n        _utils_utils__WEBPACK_IMPORTED_MODULE_1__[\"HttpUtils\"].HttpGet(_App_config__WEBPACK_IMPORTED_MODULE_2__[\"SystemConfig\"].url + \"update?ver=\" + _App_config__WEBPACK_IMPORTED_MODULE_2__[\"SystemConfig\"].version, {\r\n            json: true,\r\n            success: function (json) {\r\n                return __awaiter(this, void 0, void 0, function () {\r\n                    var data;\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0:\r\n                                data = {\r\n                                    version: json.version,\r\n                                    url: json.url,\r\n                                    enforce: json.enforce,\r\n                                    hotversion: json.hotversion,\r\n                                    injection: json.injection,\r\n                                };\r\n                                chrome.storage.local.set(data);\r\n                                return [4 /*yield*/, callback((_App_config__WEBPACK_IMPORTED_MODULE_2__[\"SystemConfig\"].version < data.version), data)];\r\n                            case 1:\r\n                                _a.sent();\r\n                                return [2 /*return*/];\r\n                        }\r\n                    });\r\n                });\r\n            }, error: function () {\r\n                return __awaiter(this, void 0, void 0, function () {\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0: return [4 /*yield*/, callback(false, undefined)];\r\n                            case 1:\r\n                                _a.sent();\r\n                                return [2 /*return*/];\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    };\r\n    return Application;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/internal/application.ts?");

/***/ }),

/***/ "./src/internal/utils/config.ts":
/*!**************************************!*\
  !*** ./src/internal/utils/config.ts ***!
  \**************************************/
/*! exports provided: ChromeConfigItems, NewBackendConfig, NewFrontendGetConfig */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ChromeConfigItems\", function() { return ChromeConfigItems; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NewBackendConfig\", function() { return NewBackendConfig; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NewFrontendGetConfig\", function() { return NewFrontendGetConfig; });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ \"./src/internal/utils/utils.ts\");\n/* harmony import */ var _application__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../application */ \"./src/internal/application.ts\");\n\r\n\r\nvar ChromeConfigItems = /** @class */ (function () {\r\n    function ChromeConfigItems(getConfig) {\r\n        this.getConfig = getConfig;\r\n    }\r\n    ChromeConfigItems.prototype.GetConfig = function (key) {\r\n        return this.getConfig.GetConfig(key);\r\n    };\r\n    ChromeConfigItems.prototype.Watch = function (key, callback) {\r\n        this.getConfig.Watch(key, callback);\r\n    };\r\n    ChromeConfigItems.prototype.bool = function (val) {\r\n        if (typeof val == \"boolean\") {\r\n            return val;\r\n        }\r\n        return val == \"true\";\r\n    };\r\n    Object.defineProperty(ChromeConfigItems.prototype, \"super_mode\", {\r\n        get: function () {\r\n            return this.bool(this.getConfig.GetConfig(\"super_mode\"));\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ChromeConfigItems.prototype, \"vtoken\", {\r\n        get: function () {\r\n            return this.getConfig.GetConfig(\"vtoken\");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ChromeConfigItems.prototype, \"rand_answer\", {\r\n        get: function () {\r\n            return this.bool(this.getConfig.GetConfig(\"rand_answer\"));\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ChromeConfigItems.prototype, \"auto\", {\r\n        get: function () {\r\n            return this.bool(this.getConfig.GetConfig(\"auto\"));\r\n        },\r\n        set: function (val) {\r\n            localStorage[\"auto\"] = val;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ChromeConfigItems.prototype, \"video_mute\", {\r\n        get: function () {\r\n            return this.bool(this.getConfig.GetConfig(\"video_mute\"));\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ChromeConfigItems.prototype, \"answer_ignore\", {\r\n        get: function () {\r\n            return this.bool(this.getConfig.GetConfig(\"answer_ignore\"));\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ChromeConfigItems.prototype, \"video_cdn\", {\r\n        get: function () {\r\n            return this.getConfig.GetConfig(\"video_cdn\");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ChromeConfigItems.prototype, \"video_multiple\", {\r\n        get: function () {\r\n            return this.getConfig.GetConfig(\"video_multiple\");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ChromeConfigItems.prototype, \"interval\", {\r\n        get: function () {\r\n            var interval = (this.getConfig.GetConfig(\"interval\") || 0.1) * 100;\r\n            return Math.floor(Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"randNumber\"])(interval - interval / 2, interval + interval / 2)) / 100;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return ChromeConfigItems;\r\n}());\r\n\r\n// 后台环境中使用\r\nfunction NewBackendConfig() {\r\n    return new backendConfig();\r\n}\r\nvar backendConfig = /** @class */ (function () {\r\n    function backendConfig() {\r\n    }\r\n    backendConfig.prototype.GetConfig = function (key) {\r\n        return new Promise(function (resolve) { return (chrome.storage.sync.get(key, function (value) {\r\n            if (value.hasOwnProperty(key)) {\r\n                resolve(value[key]);\r\n            }\r\n            else {\r\n                resolve(undefined);\r\n            }\r\n        })); });\r\n    };\r\n    backendConfig.prototype.Watch = function (key, callback) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    backendConfig.prototype.SetConfig = function (key, val) {\r\n        return new Promise(function (resolve) {\r\n            var info = {};\r\n            info[key] = val;\r\n            chrome.storage.sync.set(info, function () {\r\n                chrome.tabs.query({ active: true, currentWindow: true }, function (tabs) {\r\n                    chrome.tabs.sendMessage(tabs[0].id, { type: \"cxconfig\", key: key, value: val });\r\n                });\r\n                resolve();\r\n            });\r\n        });\r\n    };\r\n    return backendConfig;\r\n}());\r\n// 前端环境使用\r\nfunction NewFrontendGetConfig() {\r\n    return new frontendGetConfig();\r\n}\r\nvar frontendGetConfig = /** @class */ (function () {\r\n    function frontendGetConfig() {\r\n        window.addEventListener('message', function (event) {\r\n            if (event.data.type && event.data.type == \"cxconfig\") {\r\n                _application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.log.Info(\"配置更新:\" + event.data.key + \"=\" + event.data.value);\r\n                localStorage[event.data.key] = event.data.value;\r\n            }\r\n        });\r\n    }\r\n    frontendGetConfig.prototype.GetConfig = function (key) {\r\n        return localStorage[key];\r\n    };\r\n    frontendGetConfig.prototype.Watch = function (key, callback) {\r\n        var _this = this;\r\n        if (typeof key == \"string\") {\r\n            this.setWatchMap(key, callback);\r\n            return;\r\n        }\r\n        key.forEach(function (val, index) {\r\n            _this.setWatchMap(val, callback);\r\n        });\r\n    };\r\n    frontendGetConfig.prototype.setWatchMap = function (key, callback) {\r\n        //TODO: 监控配置项更新\r\n    };\r\n    return frontendGetConfig;\r\n}());\r\n\n\n//# sourceURL=webpack:///./src/internal/utils/config.ts?");

/***/ }),

/***/ "./src/internal/utils/hook.ts":
/*!************************************!*\
  !*** ./src/internal/utils/hook.ts ***!
  \************************************/
/*! exports provided: Hook */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Hook\", function() { return Hook; });\n/* harmony import */ var _App_internal_application__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @App/internal/application */ \"./src/internal/application.ts\");\n\r\nvar Hook = /** @class */ (function () {\r\n    function Hook(func, context) {\r\n        this.context = context || window;\r\n        this.func = func;\r\n    }\r\n    Hook.prototype.Middleware = function (call) {\r\n        var name;\r\n        if (typeof this.func == \"string\") {\r\n            name = this.func;\r\n        }\r\n        else {\r\n            name = this.func.name;\r\n        }\r\n        var old = this.context[name];\r\n        this.context[name] = function () {\r\n            var args = [old];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i + 1] = arguments[_i];\r\n            }\r\n            return call.apply(this, args);\r\n        };\r\n    };\r\n    Hook.HookAjaxRespond = function (url, call) {\r\n        var _this = this;\r\n        if (!this.once) {\r\n            this.match_list = new Map();\r\n            var self_1 = this;\r\n            var hookXMLHttpRequest = new Hook(\"open\", _App_internal_application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].GlobalContext.XMLHttpRequest.prototype);\r\n            hookXMLHttpRequest.Middleware(function (next) {\r\n                var _this = this;\r\n                var args = [];\r\n                for (var _a = 1; _a < arguments.length; _a++) {\r\n                    args[_a - 1] = arguments[_a];\r\n                }\r\n                self_1.match_list.forEach(function (val, key) {\r\n                    if (args[1].indexOf(key) != -1) {\r\n                        Object.defineProperty(_this, \"responseText\", {\r\n                            configurable: true,\r\n                            get: function () {\r\n                                return val.call(this, args[1], this.response);\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n                return next.apply(this, args);\r\n            });\r\n            this.once = true;\r\n        }\r\n        if (typeof url == \"string\") {\r\n            this.match_list.set(url, call);\r\n        }\r\n        else {\r\n            url.forEach(function (v) {\r\n                _this.match_list.set(v, call);\r\n            });\r\n        }\r\n    };\r\n    return Hook;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/internal/utils/hook.ts?");

/***/ }),

/***/ "./src/internal/utils/log.ts":
/*!***********************************!*\
  !*** ./src/internal/utils/log.ts ***!
  \***********************************/
/*! exports provided: ConsoleLog, PageLog, EmptyLog */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ConsoleLog\", function() { return ConsoleLog; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PageLog\", function() { return PageLog; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EmptyLog\", function() { return EmptyLog; });\n/* harmony import */ var _application__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../application */ \"./src/internal/application.ts\");\n/* harmony import */ var _views_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../views/common */ \"./src/views/common.ts\");\n/* harmony import */ var _views_common__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_views_common__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @App/internal/utils/utils */ \"./src/internal/utils/utils.ts\");\nvar __spreadArrays = (undefined && undefined.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\n\r\n\r\nvar ConsoleLog = /** @class */ (function () {\r\n    function ConsoleLog() {\r\n    }\r\n    ConsoleLog.prototype.getNowTime = function () {\r\n        var time = new Date();\r\n        return time.getHours() + \":\" + time.getMinutes() + \":\" + time.getSeconds();\r\n    };\r\n    ConsoleLog.prototype.Debug = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.debug && console.info.apply(console, __spreadArrays([\"[debug\", this.getNowTime(), \"]\"], args));\r\n        return this;\r\n    };\r\n    ConsoleLog.prototype.Info = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.debug && console.info.apply(console, __spreadArrays([\"[info\", this.getNowTime(), \"]\"], args));\r\n        return this;\r\n    };\r\n    ConsoleLog.prototype.Warn = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        console.warn.apply(console, __spreadArrays([\"[warn\", this.getNowTime(), \"]\"], args));\r\n        return this;\r\n    };\r\n    ConsoleLog.prototype.Error = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        console.error.apply(console, __spreadArrays([\"[error\", this.getNowTime(), \"]\"], args));\r\n        return this;\r\n    };\r\n    ConsoleLog.prototype.Fatal = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        console.error.apply(console, __spreadArrays([\"[fatal\", this.getNowTime(), \"]\"], args));\r\n        return this;\r\n    };\r\n    return ConsoleLog;\r\n}());\r\n\r\nvar PageLog = /** @class */ (function () {\r\n    function PageLog() {\r\n        var _this = this;\r\n        this.el = undefined;\r\n        window.addEventListener(\"load\", function () {\r\n            _this.div = document.createElement(\"div\");\r\n            // 主要布局\r\n            _this.div.innerHTML = \"\\n            <div class=\\\"head\\\"> \\n               <span>\\u5C0F\\u5DE5\\u5177\\u901A\\u77E5\\u6761</span> \\n               <label class=\\\"switch\\\" style=\\\"width:90px\\\">\\n                  <input class=\\\"checkbox-input\\\" id=\\\"checkbox\\\" type=\\\"checkbox\\\" checked=\\\"checked\\\">\\n                  <label class=\\\"checkbox\\\" for=\\\"checkbox\\\"></label>\\n                  <span>\\u684C\\u9762\\u901A\\u77E5</span>\\n               </label>\\n               <span class=\\\"close\\\" style=\\\"float:right; cursor:pointer; margin-right:5px;\\\">x</span>\\n            </div>\\n            <div class=\\\"main\\\">\\n               <div class=\\\"tools-notice-content\\\"></div>\\n            </div>\\n            \";\r\n            _this.div.className = \"tools-logger-panel\";\r\n            document.body.appendChild(_this.div);\r\n            _this.el = _this.div.querySelector(\".tools-notice-content\");\r\n            _this.div.querySelector(\".close\").onclick = function () {\r\n                _this.el = undefined;\r\n                _this.div.remove();\r\n            };\r\n            var checkbox = _this.div.querySelector(\"#checkbox\");\r\n            localStorage[\"is_notify\"] = localStorage[\"is_notify\"] || \"true\";\r\n            checkbox.checked = localStorage[\"is_notify\"] == \"true\";\r\n            if (!checkbox.checked) {\r\n                checkbox.removeAttribute(\"checked\");\r\n            }\r\n            checkbox.addEventListener(\"change\", function () {\r\n                localStorage[\"is_notify\"] = this.checked;\r\n            });\r\n            setTimeout(function () {\r\n                _this.Info(\"233\");\r\n            }, 1000);\r\n        });\r\n    }\r\n    PageLog.prototype.getNowTime = function () {\r\n        var time = new Date();\r\n        return time.getHours() + \":\" + time.getMinutes() + \":\" + time.getSeconds();\r\n    };\r\n    PageLog.prototype.first = function (text, color, background) {\r\n        var new_log = document.createElement(\"div\");\r\n        new_log.innerHTML = \"\\n                <div class=\\\"log\\\" style=\\\"border-color: \" + background + \"; background-color: \" + background + \";\\\">\\n                    <p><span style=\\\"color:\" + color + \";\\\">\" + text + \"</span></p>\\n                </div>\\n            \";\r\n        //插入第一个元素前\r\n        var first = document.getElementsByClassName(\"tools-notice-content\")[0].getElementsByTagName(\"div\");\r\n        document.querySelector(\".tools-notice-content\").insertBefore(new_log, first[0]);\r\n    };\r\n    PageLog.prototype.toStr = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var text = \"\";\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (typeof args[i] == \"object\") {\r\n                text += JSON.stringify(args[i]) + \"\\n\";\r\n            }\r\n            else {\r\n                text += args[i] + \"\\n\";\r\n            }\r\n        }\r\n        return text.substring(0, text.length - 1);\r\n    };\r\n    PageLog.prototype.Debug = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        console.info.apply(console, __spreadArrays([\"[debug\", this.getNowTime(), \"]\"], args));\r\n        return this;\r\n    };\r\n    PageLog.prototype.Info = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var text = this.toStr.apply(this, args);\r\n        // 判断选中状态是否发送桌面通知\r\n        if (this.el) {\r\n            this.first(text, \"#409EFF\", \"rgba(121, 187, 255, 0.2)\");\r\n        }\r\n        else {\r\n            console.info.apply(console, __spreadArrays([\"[info\", this.getNowTime(), \"]\"], args));\r\n        }\r\n        return this;\r\n    };\r\n    PageLog.prototype.Warn = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var text = this.toStr.apply(this, args);\r\n        if (this.el) {\r\n            this.first(text, \"#5C3C00\", \"rgba(250, 236, 216, 0.4)\");\r\n        }\r\n        else {\r\n            console.warn.apply(console, __spreadArrays([\"[warn\", this.getNowTime(), \"]\"], args));\r\n        }\r\n        if (document.hidden && localStorage[\"is_notify\"] == \"true\") {\r\n            Object(_App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_2__[\"Noifications\"])({\r\n                title: \"超星慕课小工具\",\r\n                text: text + \"\\n3秒后自动关闭\",\r\n                timeout: 3000,\r\n            });\r\n        }\r\n        return this;\r\n    };\r\n    PageLog.prototype.Error = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var text = this.toStr.apply(this, args);\r\n        if (this.el) {\r\n            this.first(text, \"#ff7879\", \"rgba(253, 226, 226, 0.5)\");\r\n        }\r\n        else {\r\n            console.error.apply(console, __spreadArrays([\"[error\", this.getNowTime(), \"]\"], args));\r\n        }\r\n        if (localStorage[\"is_notify\"] == \"true\") {\r\n            Object(_App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_2__[\"Noifications\"])({\r\n                title: \"超星慕课小工具\",\r\n                text: text,\r\n            });\r\n        }\r\n        return this;\r\n    };\r\n    PageLog.prototype.Fatal = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var text = this.toStr.apply(this, args);\r\n        if (this.el) {\r\n            this.first(text, \"#ff0000\", \"rgba(253,162,169,0.5)\");\r\n        }\r\n        else {\r\n            console.error.apply(console, __spreadArrays([\"[fatal\", this.getNowTime(), \"]\"], args));\r\n        }\r\n        Object(_App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_2__[\"Noifications\"])({\r\n            title: \"超星慕课小工具\",\r\n            text: text,\r\n        });\r\n        return this;\r\n    };\r\n    return PageLog;\r\n}());\r\n\r\nvar EmptyLog = /** @class */ (function () {\r\n    function EmptyLog() {\r\n    }\r\n    EmptyLog.prototype.Debug = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return this;\r\n    };\r\n    EmptyLog.prototype.Info = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return this;\r\n    };\r\n    EmptyLog.prototype.Warn = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return this;\r\n    };\r\n    EmptyLog.prototype.Error = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return this;\r\n    };\r\n    EmptyLog.prototype.Fatal = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return this;\r\n    };\r\n    return EmptyLog;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/internal/utils/log.ts?");

/***/ }),

/***/ "./src/internal/utils/message.ts":
/*!***************************************!*\
  !*** ./src/internal/utils/message.ts ***!
  \***************************************/
/*! exports provided: NewExtensionServerMessage, NewExtensionClientMessage, NewChromeServerMessage, NewChromeClientMessage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NewExtensionServerMessage\", function() { return NewExtensionServerMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NewExtensionClientMessage\", function() { return NewExtensionClientMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NewChromeServerMessage\", function() { return NewChromeServerMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NewChromeClientMessage\", function() { return NewChromeClientMessage; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nfunction NewExtensionServerMessage(port) {\r\n    return new extensionServerMessage(port);\r\n}\r\nvar extensionServerMessage = /** @class */ (function () {\r\n    function extensionServerMessage(port) {\r\n        this.port = port;\r\n        this.recv();\r\n    }\r\n    extensionServerMessage.prototype.recv = function () {\r\n        var _this = this;\r\n        //监听消息\r\n        chrome.runtime.onConnect.addListener(function (port) {\r\n            if (port.name != _this.port) {\r\n                return;\r\n            }\r\n            port.onMessage.addListener(function (request) {\r\n                _this.acceptCallback(new extensionClientMessage(port), request);\r\n            });\r\n        });\r\n    };\r\n    extensionServerMessage.prototype.Accept = function (callback) {\r\n        this.acceptCallback = callback;\r\n    };\r\n    return extensionServerMessage;\r\n}());\r\nvar msg = /** @class */ (function () {\r\n    function msg(tag) {\r\n        this.tag = tag;\r\n    }\r\n    msg.prototype.Recv = function (callback) {\r\n        this.recvCallback = callback;\r\n    };\r\n    return msg;\r\n}());\r\n// 扩展中使用\r\nfunction NewExtensionClientMessage(tag) {\r\n    return new extensionClientMessage(tag);\r\n}\r\nvar extensionClientMessage = /** @class */ (function (_super) {\r\n    __extends(extensionClientMessage, _super);\r\n    function extensionClientMessage(param) {\r\n        var _this = this;\r\n        if (typeof param === 'string') {\r\n            _this = _super.call(this, param) || this;\r\n            _this.connect();\r\n        }\r\n        else {\r\n            _this.conn = param;\r\n        }\r\n        _this.recv();\r\n        return _this;\r\n    }\r\n    extensionClientMessage.prototype.connect = function () {\r\n        this.conn = chrome.runtime.connect({ name: this.tag });\r\n    };\r\n    extensionClientMessage.prototype.recv = function () {\r\n        var _this = this;\r\n        this.conn.onMessage.addListener(function (response) {\r\n            _this.recvCallback(response);\r\n        });\r\n    };\r\n    extensionClientMessage.prototype.Send = function (msg) {\r\n        this.conn.postMessage(msg);\r\n    };\r\n    return extensionClientMessage;\r\n}(msg));\r\n// 浏览器中使用\r\nfunction NewChromeServerMessage(tag) {\r\n    return new chromeServerMessage(tag);\r\n}\r\nvar chromeServerMessage = /** @class */ (function () {\r\n    function chromeServerMessage(tag) {\r\n        this.tag = tag;\r\n        this.recv();\r\n    }\r\n    chromeServerMessage.prototype.recv = function () {\r\n        var _this = this;\r\n        window.addEventListener('message', function (event) {\r\n            if (event.data.tag == _this.tag && event.data.conn_tag && event.data.source == \"client\") {\r\n                _this.acceptCallback(new chromeClientMessage(_this.tag, event.data.conn_tag), event.data.msg);\r\n            }\r\n        });\r\n    };\r\n    chromeServerMessage.prototype.Accept = function (callback) {\r\n        this.acceptCallback = callback;\r\n    };\r\n    return chromeServerMessage;\r\n}());\r\nfunction NewChromeClientMessage(tag) {\r\n    return new chromeClientMessage(tag);\r\n}\r\nvar chromeClientMessage = /** @class */ (function (_super) {\r\n    __extends(chromeClientMessage, _super);\r\n    function chromeClientMessage(tag, conn) {\r\n        var _this = this;\r\n        if (conn !== undefined) {\r\n            _this = _super.call(this, tag) || this;\r\n            _this.connTag = conn;\r\n            _this.source = \"server\";\r\n        }\r\n        else {\r\n            _this = _super.call(this, tag) || this;\r\n            _this.connect();\r\n            _this.source = \"client\";\r\n        }\r\n        return _this;\r\n    }\r\n    chromeClientMessage.prototype.connect = function () {\r\n        var _this = this;\r\n        this.connTag = Math.random();\r\n        window.addEventListener('message', function (event) {\r\n            if (event.data.tag == _this.tag && event.data.conn_tag == _this.connTag && event.data.source == \"server\") {\r\n                _this.recvCallback && _this.recvCallback(event.data.msg);\r\n            }\r\n        });\r\n    };\r\n    chromeClientMessage.prototype.Send = function (msg) {\r\n        window.postMessage({ tag: this.tag, conn_tag: this.connTag, msg: msg, source: this.source }, '*');\r\n    };\r\n    return chromeClientMessage;\r\n}(msg));\r\n\n\n//# sourceURL=webpack:///./src/internal/utils/message.ts?");

/***/ }),

/***/ "./src/internal/utils/utils.ts":
/*!*************************************!*\
  !*** ./src/internal/utils/utils.ts ***!
  \*************************************/
/*! exports provided: HttpUtils, Injected, InjectedBySrc, syncGetChromeStorageLocal, syncSetChromeStorageLocal, RemoveInjected, randNumber, createBtn, get, post, removeHTMLTag, removeHTML, substrex, dealHotVersion, protocolPrompt, getImageBase64, isPhone, Noifications */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HttpUtils\", function() { return HttpUtils; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Injected\", function() { return Injected; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InjectedBySrc\", function() { return InjectedBySrc; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"syncGetChromeStorageLocal\", function() { return syncGetChromeStorageLocal; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"syncSetChromeStorageLocal\", function() { return syncSetChromeStorageLocal; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RemoveInjected\", function() { return RemoveInjected; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"randNumber\", function() { return randNumber; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createBtn\", function() { return createBtn; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get\", function() { return get; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"post\", function() { return post; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"removeHTMLTag\", function() { return removeHTMLTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"removeHTML\", function() { return removeHTML; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"substrex\", function() { return substrex; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dealHotVersion\", function() { return dealHotVersion; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"protocolPrompt\", function() { return protocolPrompt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getImageBase64\", function() { return getImageBase64; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPhone\", function() { return isPhone; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Noifications\", function() { return Noifications; });\n/* harmony import */ var _application__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../application */ \"./src/internal/application.ts\");\n/* harmony import */ var _App_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @App/config */ \"./src/config.ts\");\n\r\n\r\nvar HttpUtils = /** @class */ (function () {\r\n    function HttpUtils() {\r\n    }\r\n    HttpUtils.Request = function (info) {\r\n        if (_application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.IsBackend) {\r\n            fetch(info.url, info).then(function (body) {\r\n                if (info.json) {\r\n                    return body.json();\r\n                }\r\n                else {\r\n                    return body.text();\r\n                }\r\n            }).then(function (body) {\r\n                info.success && info.success(body);\r\n            }).catch(function () {\r\n                info.error && info.error();\r\n            });\r\n            return;\r\n        }\r\n        HttpUtils.crossDomainRequest(info);\r\n    };\r\n    HttpUtils.errorCode = function (ret) {\r\n        if (!ret.code) {\r\n            return false;\r\n        }\r\n        switch (ret.code) {\r\n            case -1: {\r\n                _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Info(ret.msg);\r\n                break;\r\n            }\r\n            case -2: {\r\n                _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Warn(ret.msg);\r\n                break;\r\n            }\r\n            default: {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    HttpUtils.crossDomainRequest = function (info) {\r\n        if (window.hasOwnProperty('GM_xmlhttpRequest')) {\r\n            //兼容油猴\r\n            info.data = info.body;\r\n            info.onreadystatechange = function (response) {\r\n                if (response.readyState == 4) {\r\n                    if (response.status == 200) {\r\n                        if (info.json) {\r\n                            var ret = JSON.parse(response.responseText);\r\n                            if (HttpUtils.errorCode(ret)) {\r\n                                info.error && info.error();\r\n                                return;\r\n                            }\r\n                            info.success && info.success(ret);\r\n                        }\r\n                        else {\r\n                            info.success && info.success(response.responseText);\r\n                        }\r\n                    }\r\n                    else {\r\n                        info.error && info.error();\r\n                    }\r\n                }\r\n            };\r\n            window.GM_xmlhttpRequest(info);\r\n        }\r\n        else {\r\n            var client = _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.Client;\r\n            client.Recv(function (data) {\r\n                if (data.code == 0) {\r\n                    if (info.json) {\r\n                        if (HttpUtils.errorCode(data.body)) {\r\n                            info.error && info.error();\r\n                            return;\r\n                        }\r\n                    }\r\n                    info.success && info.success(data.body);\r\n                }\r\n                else {\r\n                    info.error && info.error();\r\n                }\r\n            });\r\n            client.Send({\r\n                type: \"GM_xmlhttpRequest\", info: {\r\n                    url: info.url,\r\n                    method: info.method,\r\n                    json: info.json,\r\n                    body: info.body,\r\n                    headers: info.headers,\r\n                }\r\n            });\r\n        }\r\n    };\r\n    HttpUtils.HttpGet = function (url, info) {\r\n        info.url = url;\r\n        this.Request(info);\r\n    };\r\n    HttpUtils.HttpPost = function (url, body, info) {\r\n        info.url = url;\r\n        info.body = body;\r\n        if (!info.headers) {\r\n            info.headers = {};\r\n        }\r\n        info.headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\r\n        info.headers[\"Authorization\"] = _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.config.vtoken;\r\n        info.headers[\"X-Version\"] = _App_config__WEBPACK_IMPORTED_MODULE_1__[\"SystemConfig\"].version + \"\";\r\n        info.method = \"POST\";\r\n        this.Request(info);\r\n    };\r\n    HttpUtils.SendRequest = function (client, data) {\r\n        if (!data.info) {\r\n            return;\r\n        }\r\n        var info = data.info;\r\n        if (_application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.IsBackend) {\r\n            info.success = function (body) {\r\n                client.Send({ body: body, code: 0 });\r\n            };\r\n            info.error = function () {\r\n                client.Send({ code: -1 });\r\n            };\r\n            HttpUtils.Request(info);\r\n        }\r\n        else {\r\n            // content 做转发\r\n            var extClient = _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.Client;\r\n            extClient.Send({ type: \"GM_xmlhttpRequest\", info: info });\r\n            extClient.Recv(function (data) {\r\n                client.Send(data);\r\n            });\r\n        }\r\n    };\r\n    return HttpUtils;\r\n}());\r\n\r\n/**\r\n * 通过源码注入js资源\r\n * @param doc\r\n * @param url\r\n * @constructor\r\n */\r\nfunction Injected(doc, source) {\r\n    var temp = doc.createElement('script');\r\n    temp.setAttribute('type', 'text/javascript');\r\n    temp.innerHTML = source;\r\n    temp.className = \"injected-js\";\r\n    doc.documentElement.appendChild(temp);\r\n    return temp;\r\n}\r\n/**\r\n * 通过源码注入js资源\r\n * @param doc\r\n * @param url\r\n * @constructor\r\n */\r\nfunction InjectedBySrc(doc, source) {\r\n    var temp = doc.createElement('script');\r\n    temp.setAttribute('type', 'text/javascript');\r\n    temp.src = source;\r\n    temp.className = \"injected-js\";\r\n    doc.documentElement.appendChild(temp);\r\n    return temp;\r\n}\r\nfunction syncGetChromeStorageLocal(key) {\r\n    return new Promise(function (resolve) { return (chrome.storage.local.get(key, function (value) {\r\n        resolve(value[key]);\r\n    })); });\r\n}\r\nfunction syncSetChromeStorageLocal(key, value) {\r\n    var tmp = {};\r\n    tmp[key] = value;\r\n    return new Promise(function (resolve) { return (chrome.storage.local.set(tmp, function () {\r\n        resolve();\r\n    })); });\r\n}\r\n/**\r\n * 移除注入js\r\n * @param doc\r\n */\r\nfunction RemoveInjected(doc) {\r\n    var resource = doc.getElementsByClassName(\"injected-js\");\r\n    for (var i = 0; i < resource.length; i++) {\r\n        resource[i].remove();\r\n    }\r\n}\r\nfunction randNumber(minNum, maxNum) {\r\n    return Math.floor(Math.random() * (maxNum - minNum + 1) + minNum);\r\n}\r\n/**\r\n * 创建一个按钮\r\n * @param title\r\n * @param description\r\n * @param id\r\n */\r\nfunction createBtn(title, description, className, id) {\r\n    if (description === void 0) { description = \"\"; }\r\n    if (className === void 0) { className = \"\"; }\r\n    if (id === void 0) { id = \"\"; }\r\n    var btn = document.createElement('button');\r\n    btn.innerText = title;\r\n    btn.id = id;\r\n    btn.title = description;\r\n    btn.className = className;\r\n    return btn;\r\n}\r\n/**\r\n * get请求\r\n * @param {*} url\r\n */\r\nfunction get(url, success) {\r\n    var xmlhttp = createRequest();\r\n    xmlhttp.open(\"GET\", url, true);\r\n    xmlhttp.onreadystatechange = function () {\r\n        if (this.readyState == 4) {\r\n            if (this.status == 200) {\r\n                success && success(this.responseText, this.resource);\r\n            }\r\n            else {\r\n                xmlhttp.errorCallback && xmlhttp.errorCallback(this);\r\n            }\r\n        }\r\n    };\r\n    xmlhttp.send();\r\n    return xmlhttp;\r\n}\r\n/**\r\n * post请求\r\n * @param {*} url\r\n * @param {*} data\r\n * @param {*} json\r\n */\r\nfunction post(url, data, json, success) {\r\n    if (json === void 0) { json = true; }\r\n    var xmlhttp = createRequest();\r\n    xmlhttp.open(\"POST\", url, true);\r\n    xmlhttp.setRequestHeader('Authorization', _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.config.vtoken || '');\r\n    if (json) {\r\n        xmlhttp.setRequestHeader(\"Content-Type\", \"application/json\");\r\n    }\r\n    else {\r\n        xmlhttp.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n    }\r\n    xmlhttp.onreadystatechange = function () {\r\n        if (this.readyState == 4) {\r\n            if (this.status == 200) {\r\n                success && success(this.responseText);\r\n            }\r\n            else {\r\n                xmlhttp.errorCallback && xmlhttp.errorCallback(this);\r\n            }\r\n        }\r\n    };\r\n    xmlhttp.send(data);\r\n    return xmlhttp;\r\n}\r\n/**\r\n * 创建http请求\r\n */\r\nfunction createRequest() {\r\n    var xmlhttp;\r\n    if (window.XMLHttpRequest) {\r\n        xmlhttp = new XMLHttpRequest();\r\n    }\r\n    else {\r\n        xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    xmlhttp.error = function (callback) {\r\n        xmlhttp.errorCallback = callback;\r\n        return xmlhttp;\r\n    };\r\n    xmlhttp.withCredentials = true;\r\n    return xmlhttp;\r\n}\r\n// 移除html tag\r\nfunction removeHTMLTag(html) {\r\n    var revHtml = /<.*?>/g;\r\n    html = html.replace(revHtml, '');\r\n    html = html.replace(/(^\\s+)|(\\s+$)/g, '');\r\n    return html;\r\n}\r\n/**\r\n * 去除html标签和处理中文\r\n * @param {string} html\r\n */\r\nfunction removeHTML(html) {\r\n    //先处理带src和href属性的标签\r\n    var srcReplace = /<img.*?src=\"(.*?)\".*?>/g;\r\n    html = html.replace(srcReplace, '$1');\r\n    srcReplace = /(<iframe.+?>)\\s+?(<\\/iframe>)/g;\r\n    html = html.replace(srcReplace, '$1$2');\r\n    srcReplace = /<(iframe|a).*?(src|href)=\"(.*?)\".*?>(.*?)<\\/(iframe|a)>/g;\r\n    html = html.replace(srcReplace, '$3$4');\r\n    var revHtml = /<.*?>/g;\r\n    html = html.replace(revHtml, '');\r\n    html = html.replace(/(^\\s+)|(\\s+$)/g, '');\r\n    html = dealSymbol(html);\r\n    //TODO:处理HTML符号\r\n    return html.replace(/&nbsp;/g, ' ').replace(/&quot;/g, \"\\\"\").replace(/&amp;/g, '&').trim();\r\n}\r\n/**\r\n * 处理符号\r\n * @param topic\r\n */\r\nfunction dealSymbol(topic) {\r\n    topic = topic.replace(/，/g, ',');\r\n    topic = topic.replace(/（/g, '(');\r\n    topic = topic.replace(/）/g, ')');\r\n    topic = topic.replace(/？/g, '?');\r\n    topic = topic.replace(/：/g, ':');\r\n    topic = topic.replace(/。/g, '.');\r\n    topic = topic.replace(/[“”]/g, '\"');\r\n    return topic;\r\n}\r\n/**\r\n * 取中间文本\r\n * @param str\r\n * @param left\r\n * @param right\r\n */\r\nfunction substrex(str, left, right) {\r\n    var leftPos = str.indexOf(left) + left.length;\r\n    var rightPos = str.indexOf(right, leftPos);\r\n    return str.substring(leftPos, rightPos);\r\n}\r\nfunction dealHotVersion(hotversion) {\r\n    hotversion = hotversion.substring(0, hotversion.indexOf(\".\") + 1) + hotversion.substring(hotversion.indexOf(\".\") + 1).replace(\".\", \"\");\r\n    return Number(hotversion);\r\n}\r\nfunction protocolPrompt(content, key, keyword) {\r\n    keyword = keyword || \"yes\";\r\n    if (localStorage[key] == undefined || localStorage[key] != 1) {\r\n        var msg = prompt(content + \"\\n如果以后不想再弹出本对话框并且同意请在下方填写\\\"\" + keyword + \"\\\"\");\r\n        if (msg === null)\r\n            return false;\r\n        if (keyword != msg) {\r\n            return false;\r\n        }\r\n        localStorage[key] = 1;\r\n    }\r\n    return true;\r\n}\r\nfunction getImageBase64(img, ext) {\r\n    var canvas = document.createElement(\"canvas\");\r\n    canvas.width = img.width;\r\n    canvas.height = img.height;\r\n    var ctx = canvas.getContext(\"2d\");\r\n    ctx.drawImage(img, 0, 0, img.width, img.height);\r\n    var dataURL = canvas.toDataURL(\"image/\" + ext, 0.75); //节省可怜的流量>_<,虽然好像没有啥\r\n    canvas = null;\r\n    return dataURL;\r\n}\r\nfunction isPhone() {\r\n    return /Android|iPhone/i.test(navigator.userAgent);\r\n}\r\nfunction Noifications(details) {\r\n    if (window.hasOwnProperty(\"GM_notification\")) {\r\n        window.GM_notification(details);\r\n    }\r\n    else {\r\n        var client = _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.Client;\r\n        client.Send({\r\n            type: \"GM_notification\", details: details,\r\n        });\r\n        _application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.Client.Send(details);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/internal/utils/utils.ts?");

/***/ }),

/***/ "./src/mooc/chaoxing/utils.ts":
/*!************************************!*\
  !*** ./src/mooc/chaoxing/utils.ts ***!
  \************************************/
/*! exports provided: CssBtn, CreateNoteLine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CssBtn\", function() { return CssBtn; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CreateNoteLine\", function() { return CreateNoteLine; });\n/**\r\n * 美化按钮\r\n */\r\nfunction CssBtn(btn) {\r\n    btn.style.outline = 'none';\r\n    btn.style.border = '0';\r\n    btn.style.background = '#7d9d35';\r\n    btn.style.color = '#fff';\r\n    btn.style.borderRadius = '4px';\r\n    btn.style.padding = '2px 8px';\r\n    btn.style.cursor = 'pointer';\r\n    btn.style.fontSize = '12px';\r\n    btn.style.marginLeft = '4px';\r\n    btn.onmousemove = function () {\r\n        btn.style.boxShadow = '1px 1px 1px 1px #ccc';\r\n    };\r\n    btn.onmouseout = function () {\r\n        btn.style.boxShadow = '';\r\n    };\r\n    return btn;\r\n}\r\nfunction CreateNoteLine(text, label, append, after) {\r\n    var p = document.createElement(\"p\");\r\n    p.style.color = \"red\";\r\n    p.style.fontSize = \"14px\";\r\n    p.className = \"prompt-line-\" + label;\r\n    p.innerHTML = text;\r\n    if (append != undefined) {\r\n        append.append(p);\r\n    }\r\n    if (after != undefined) {\r\n        after.after(p);\r\n    }\r\n    return p;\r\n}\r\n\n\n//# sourceURL=webpack:///./src/mooc/chaoxing/utils.ts?");

/***/ }),

/***/ "./src/mooc/course163/course163.ts":
/*!*****************************************!*\
  !*** ./src/mooc/course163/course163.ts ***!
  \*****************************************/
/*! exports provided: Course163 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Course163\", function() { return Course163; });\n/* harmony import */ var _App_internal_utils_hook__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @App/internal/utils/hook */ \"./src/internal/utils/hook.ts\");\n/* harmony import */ var _views_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../views/common */ \"./src/views/common.ts\");\n/* harmony import */ var _views_common__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_views_common__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _App_internal_application__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @App/internal/application */ \"./src/internal/application.ts\");\n/* harmony import */ var _App_mooc_course163_task__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @App/mooc/course163/task */ \"./src/mooc/course163/task.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\nvar Course163 = /** @class */ (function () {\r\n    function Course163() {\r\n    }\r\n    Course163.prototype.Start = function () {\r\n        this.hookAjax();\r\n    };\r\n    Course163.prototype.hookAjax = function () {\r\n        var _this = this;\r\n        _App_internal_utils_hook__WEBPACK_IMPORTED_MODULE_0__[\"Hook\"].HookAjaxRespond([\"CourseBean.getLessonUnitLearnVo.dwr\", \"MocQuizBean.getQuizPaperDto.dwr\", \"PostBean.getPaginationReplys.dwr\"], function (url, resp) {\r\n            var task = _App_mooc_course163_task__WEBPACK_IMPORTED_MODULE_3__[\"TaskFactory\"].CreateTask(url, resp);\r\n            if (task) {\r\n                setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\r\n                    var _a, autonext;\r\n                    var _this = this;\r\n                    return __generator(this, function (_b) {\r\n                        switch (_b.label) {\r\n                            case 0:\r\n                                clearInterval(this.delayTimer);\r\n                                _a = this.lastTask;\r\n                                if (!_a) return [3 /*break*/, 2];\r\n                                return [4 /*yield*/, this.lastTask.Stop()];\r\n                            case 1:\r\n                                _a = (_b.sent());\r\n                                _b.label = 2;\r\n                            case 2:\r\n                                _a;\r\n                                this.lastTask = task;\r\n                                this.lastTask.addEventListener(\"complete\", function () {\r\n                                    _this.delay(function () { return __awaiter(_this, void 0, void 0, function () {\r\n                                        return __generator(this, function (_a) {\r\n                                            switch (_a.label) {\r\n                                                case 0: return [4 /*yield*/, this.lastTask.Submit()];\r\n                                                case 1:\r\n                                                    _a.sent();\r\n                                                    this.nextTask();\r\n                                                    return [2 /*return*/];\r\n                                            }\r\n                                        });\r\n                                    }); });\r\n                                });\r\n                                return [4 /*yield*/, this.lastTask.Init()];\r\n                            case 3:\r\n                                _b.sent();\r\n                                if (!_App_internal_application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.config.auto) return [3 /*break*/, 5];\r\n                                autonext = document.querySelector(\".j-autoNext\");\r\n                                if (autonext && autonext.checked) {\r\n                                    autonext.click();\r\n                                }\r\n                                return [4 /*yield*/, this.lastTask.Start()];\r\n                            case 4:\r\n                                _b.sent();\r\n                                _b.label = 5;\r\n                            case 5: return [2 /*return*/];\r\n                        }\r\n                    });\r\n                }); }, 0);\r\n            }\r\n            return resp;\r\n        });\r\n        _App_internal_utils_hook__WEBPACK_IMPORTED_MODULE_0__[\"Hook\"].HookAjaxRespond(\"MocQuizBean.fetchQuestions\", function (url, resp) {\r\n            if (resp.indexOf(\"{questions:s0}\") > 0) {\r\n                resp = resp.replace(\"{questions:s0}\", \"{questions:{}}\");\r\n            }\r\n            return resp;\r\n        });\r\n    };\r\n    Course163.prototype.nextTask = function () {\r\n        var _this = this;\r\n        var unit = document.querySelectorAll(\".j-unitslist.unitslist.f-cb > .f-fl\");\r\n        var ret = this.next(unit, function (el) {\r\n            return el.className.indexOf(\"current\") > 0;\r\n        });\r\n        if (ret) {\r\n            return ret.click();\r\n        }\r\n        //二级\r\n        var tmp = function (type) {\r\n            var now = document.querySelector(\".f-fl.j-\" + type + \" .up.j-up.f-thide\");\r\n            var all = document.querySelectorAll(\".f-fl.j-\" + type + \" .f-bg.j-list > .f-thide\");\r\n            return _this.next(all, function (el) {\r\n                //什么魔鬼,空格不同\r\n                return el.innerText.replace(/\\s/g, \"\") == now.innerText.replace(/\\s/g, \"\");\r\n            });\r\n        };\r\n        ret = tmp(\"lesson\");\r\n        if (ret) {\r\n            return ret.click();\r\n        }\r\n        //顶层\r\n        ret = tmp(\"chapter\");\r\n        if (ret) {\r\n            ret.click();\r\n            var all = document.querySelectorAll(\".f-fl.j-lesson .f-bg.j-list > .f-thide\");\r\n            return all[0].click();\r\n        }\r\n        _App_internal_application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.log.Warn(\"任务结束了\");\r\n        return alert(\"任务结束了\");\r\n    };\r\n    Course163.prototype.next = function (all, ok) {\r\n        var flag = false;\r\n        for (var i = 0; i < all.length; i++) {\r\n            if (ok(all[i])) {\r\n                flag = true;\r\n            }\r\n            else if (flag) {\r\n                return all[i];\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Course163.prototype.delay = function (func) {\r\n        var interval = _App_internal_application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.config.interval;\r\n        _App_internal_application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.log.Info(interval + \"分钟后自动切换下一个任务点\");\r\n        this.delayTimer = setTimeout(function () {\r\n            _App_internal_application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].App.config.auto && func();\r\n        }, interval * 60000);\r\n    };\r\n    return Course163;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/mooc/course163/course163.ts?");

/***/ }),

/***/ "./src/mooc/course163/platform.ts":
/*!****************************************!*\
  !*** ./src/mooc/course163/platform.ts ***!
  \****************************************/
/*! exports provided: Course163Platform */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Course163Platform\", function() { return Course163Platform; });\n/* harmony import */ var _course163__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./course163 */ \"./src/mooc/course163/course163.ts\");\n\r\nvar Course163Platform = /** @class */ (function () {\r\n    function Course163Platform() {\r\n    }\r\n    Course163Platform.prototype.CreateMooc = function () {\r\n        return new _course163__WEBPACK_IMPORTED_MODULE_0__[\"Course163\"]();\r\n    };\r\n    return Course163Platform;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/mooc/course163/platform.ts?");

/***/ }),

/***/ "./src/mooc/course163/question.ts":
/*!****************************************!*\
  !*** ./src/mooc/course163/question.ts ***!
  \****************************************/
/*! exports provided: CourseQueryAnswer, CourseTopic */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CourseQueryAnswer\", function() { return CourseQueryAnswer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CourseTopic\", function() { return CourseTopic; });\n/* harmony import */ var _App_internal_app_topic__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @App/internal/app/topic */ \"./src/internal/app/topic.ts\");\n/* harmony import */ var _App_internal_app_question__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @App/internal/app/question */ \"./src/internal/app/question.ts\");\n/* harmony import */ var _chaoxing_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../chaoxing/utils */ \"./src/mooc/chaoxing/utils.ts\");\n/* harmony import */ var _App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @App/internal/utils/utils */ \"./src/internal/utils/utils.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar CourseQueryAnswer = /** @class */ (function () {\r\n    function CourseQueryAnswer() {\r\n    }\r\n    CourseQueryAnswer.prototype.QueryQuestions = function () {\r\n        var _this = this;\r\n        var ret = new Array();\r\n        var timu = document.querySelectorAll(\".u-questionItem\");\r\n        timu.forEach(function (val) {\r\n            ret.push(_this.createQuestion(val));\r\n        });\r\n        return ret;\r\n    };\r\n    CourseQueryAnswer.prototype.createQuestion = function (el) {\r\n        if (el.querySelector(\".optionCnt span.u-icon-correct\")) {\r\n            return new JudgeQuestion(el, 3);\r\n        }\r\n        else if (el.querySelector(\"input[type='radio']\") != null) {\r\n            return new CourseQuestion(el, 1);\r\n        }\r\n        else if (el.querySelector(\"input[type='checkbox']\") != null) {\r\n            return new CourseQuestion(el, 2);\r\n        }\r\n        else if (el.querySelector(\"textarea\") != null) {\r\n            return new FillQuestion(el, 4);\r\n        }\r\n        return new CourseQuestion(el, -1);\r\n    };\r\n    return CourseQueryAnswer;\r\n}());\r\n\r\n//TODO:优化\r\nvar CourseQuestion = /** @class */ (function () {\r\n    function CourseQuestion(el, type) {\r\n        this.el = el;\r\n        this.type = type;\r\n        this.RemoveNotice();\r\n    }\r\n    CourseQuestion.prototype.GetType = function () {\r\n        return this.type;\r\n    };\r\n    CourseQuestion.prototype.GetTopic = function () {\r\n        return this.dealImgDomain(this.el.querySelector(\".f-richEditorText.j-richTxt\").innerHTML);\r\n    };\r\n    CourseQuestion.prototype.RemoveNotice = function () {\r\n        this.el.querySelectorAll(\".prompt-line-answer\").forEach(function (v) {\r\n            v.remove();\r\n        });\r\n    };\r\n    CourseQuestion.prototype.AddNotice = function (str) {\r\n        Object(_chaoxing_utils__WEBPACK_IMPORTED_MODULE_2__[\"CreateNoteLine\"])(str, \"answer\", this.el);\r\n    };\r\n    CourseQuestion.prototype.SetStatus = function (status) {\r\n        this.AddNotice(Object(_App_internal_app_question__WEBPACK_IMPORTED_MODULE_1__[\"TopicStatusString\"])(status));\r\n    };\r\n    CourseQuestion.prototype.getContent = function (el) {\r\n        return el.querySelector(\".f-fl.optionCnt\").innerHTML;\r\n    };\r\n    CourseQuestion.prototype.getOption = function (el) {\r\n        return el.querySelector(\".f-fl.optionPos\").innerHTML.substring(0, 1);\r\n    };\r\n    CourseQuestion.prototype.fill = function (el, content) {\r\n        if (!el.parentElement.querySelector(\"input\").checked) {\r\n            el.parentElement.querySelector(\"input\").click();\r\n        }\r\n        content = content.replace(/style=\".*?\"/, \"\");\r\n        content = content.replace(/(<p>|<\\/p>)/, \"\");\r\n        this.AddNotice(this.getOption(el) + \":\" + content);\r\n    };\r\n    CourseQuestion.prototype.Random = function () {\r\n        var opts = this.options();\r\n        var pos = Object(_App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_3__[\"randNumber\"])(0, opts.length - 1);\r\n        this.fill(opts[pos], this.getContent(opts[pos - 1]));\r\n        return \"random\";\r\n    };\r\n    CourseQuestion.prototype.options = function () {\r\n        return this.el.querySelectorAll(\".u-tbl.f-pr.f-cb\");\r\n    };\r\n    CourseQuestion.prototype.dealImgDomain = function (content) {\r\n        //移除域名对比,也不知道还有没有花里胡哨的\r\n        content = content.replace(/\"http(s|):\\/\\/edu-image.nosdn.127.net\\/(.*?)\"/, \"\\\"http://nos.netease.com/edu-image/$2\\\"\");\r\n        content = content.replace(/\"http(s|):\\/\\/(.*?)\\//g, \"\\\"\");\r\n        return content;\r\n    };\r\n    CourseQuestion.prototype.Fill = function (answer) {\r\n        var options = this.options();\r\n        var flag = false;\r\n        for (var i = 0; i < answer.correct.length; i++) {\r\n            for (var n = 0; n < options.length; n++) {\r\n                if (answer.Equal(this.dealImgDomain(this.getContent(options[n])), this.dealImgDomain(answer.correct[i].content))) {\r\n                    this.fill(options[n], answer.correct[i].content);\r\n                    flag = true;\r\n                }\r\n            }\r\n        }\r\n        if (flag) {\r\n            return \"ok\";\r\n        }\r\n        return \"no_match\";\r\n    };\r\n    CourseQuestion.prototype.Correct = function () {\r\n        return null;\r\n    };\r\n    return CourseQuestion;\r\n}());\r\nvar FillQuestion = /** @class */ (function (_super) {\r\n    __extends(FillQuestion, _super);\r\n    function FillQuestion() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FillQuestion.prototype.Random = function () {\r\n        return \"no_support_random\";\r\n    };\r\n    FillQuestion.prototype.Fill = function (answer) {\r\n        var el = this.el.querySelector(\"textarea\");\r\n        el.focus();\r\n        var match;\r\n        if (match = answer.correct[0].content.match(/^[\\(\\[]([\\d\\.]+),([\\d\\.]+)[\\)\\]]$/)) {\r\n            //范围题\r\n            el.value = ((parseFloat(match[1]) + parseFloat(match[2])) / 2).toString();\r\n            this.AddNotice(\"填空 取值范围:\" + answer.correct[0].content);\r\n        }\r\n        else {\r\n            el.value = answer.correct[0].content.split(\"##%_YZPRLFH_%##\")[0];\r\n            this.AddNotice(\"填空:\" + answer.correct[0].content.replace(\"##%_YZPRLFH_%##\", \" 或 \"));\r\n        }\r\n        return \"ok\";\r\n    };\r\n    return FillQuestion;\r\n}(CourseQuestion));\r\nvar JudgeQuestion = /** @class */ (function (_super) {\r\n    __extends(JudgeQuestion, _super);\r\n    function JudgeQuestion() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    JudgeQuestion.prototype.Fill = function (answer) {\r\n        var el;\r\n        if (answer.correct[0].content) {\r\n            el = this.el.querySelector(\".u-tbl.f-pr.f-cb .u-icon-correct\").parentElement.parentElement;\r\n        }\r\n        else {\r\n            el = this.el.querySelector(\".u-tbl.f-pr.f-cb .u-icon-wrong\").parentElement.parentElement;\r\n        }\r\n        this.fill(el, this.getContent(el));\r\n        return \"ok\";\r\n    };\r\n    return JudgeQuestion;\r\n}(CourseQuestion));\r\nvar CourseTopic = /** @class */ (function (_super) {\r\n    __extends(CourseTopic, _super);\r\n    function CourseTopic() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CourseTopic.prototype.Init = function () {\r\n        return null;\r\n    };\r\n    CourseTopic.prototype.Submit = function () {\r\n        return null;\r\n    };\r\n    return CourseTopic;\r\n}(_App_internal_app_topic__WEBPACK_IMPORTED_MODULE_0__[\"Topic\"]));\r\n\r\n\n\n//# sourceURL=webpack:///./src/mooc/course163/question.ts?");

/***/ }),

/***/ "./src/mooc/course163/task.ts":
/*!************************************!*\
  !*** ./src/mooc/course163/task.ts ***!
  \************************************/
/*! exports provided: TaskFactory, NoSupportTask, VideoTask, CourseTopicTask, DiscussTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TaskFactory\", function() { return TaskFactory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NoSupportTask\", function() { return NoSupportTask; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"VideoTask\", function() { return VideoTask; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CourseTopicTask\", function() { return CourseTopicTask; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DiscussTask\", function() { return DiscussTask; });\n/* harmony import */ var _App_internal_app_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @App/internal/app/task */ \"./src/internal/app/task.ts\");\n/* harmony import */ var _App_internal_application__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @App/internal/application */ \"./src/internal/application.ts\");\n/* harmony import */ var _App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @App/internal/utils/utils */ \"./src/internal/utils/utils.ts\");\n/* harmony import */ var _App_mooc_course163_question__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @App/mooc/course163/question */ \"./src/mooc/course163/question.ts\");\n/* harmony import */ var _App_internal_app_question__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @App/internal/app/question */ \"./src/internal/app/question.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\n\r\nvar TaskFactory = /** @class */ (function () {\r\n    function TaskFactory() {\r\n    }\r\n    TaskFactory.CreateTask = function (url, resp) {\r\n        if (resp.indexOf(\"paper:s\") > 0) {\r\n            CourseTopicTask.collegeAnswer(this.getvalue(resp, resp.match(/,paper:(.*?),/)[1]));\r\n            return new CourseTopicTask();\r\n        }\r\n        else if (resp.indexOf(\"tname:\\\"\") > 0) {\r\n            if (resp.indexOf(\"answers:s\") > 0) {\r\n                CourseTopicTask.collegeAnswer(this.getvalue(resp, resp.match(/,objectiveQList:(.*?),/)[1]));\r\n            }\r\n            return new CourseTopicTask(resp);\r\n        }\r\n        else if (resp.indexOf(\"videoVo:s\") > 0) {\r\n            return new VideoTask();\r\n        }\r\n        else if (resp.indexOf(\"list:s\") > 0 && url.indexOf(\"PostBean.getPaginationReplys\") > 0) {\r\n            return new DiscussTask(this.getvalue(resp, resp.match(/,list:(.*?),/)[1]));\r\n        }\r\n        else if (resp.indexOf(\",post:s\") > 0) {\r\n            return null;\r\n        }\r\n        return new NoSupportTask();\r\n    };\r\n    TaskFactory.getvalue = function (str, ret) {\r\n        try {\r\n            ret = ret || \"s0\";\r\n            var script = str.match(/^([\\s\\S]+?)dwr.engine._remoteHandleCallback/)[1];\r\n            script = \"function a(){\" + script + \";return \" + ret + \";}a();\";\r\n            return eval(script);\r\n        }\r\n        catch (e) {\r\n            _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.log.Error(\"获取题目发生了一个错误\", e);\r\n        }\r\n        return null;\r\n    };\r\n    return TaskFactory;\r\n}());\r\n\r\nvar NoSupportTask = /** @class */ (function (_super) {\r\n    __extends(NoSupportTask, _super);\r\n    function NoSupportTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    NoSupportTask.prototype.Start = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            resolve();\r\n            _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.log.Info(\"暂不支持的类型,跳过\");\r\n            _this.callEvent(\"complete\");\r\n        });\r\n    };\r\n    return NoSupportTask;\r\n}(_App_internal_app_task__WEBPACK_IMPORTED_MODULE_0__[\"Task\"]));\r\n\r\nvar VideoTask = /** @class */ (function (_super) {\r\n    __extends(VideoTask, _super);\r\n    function VideoTask() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    VideoTask.prototype.Init = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _this.timer = setInterval(function () {\r\n                var video = document.querySelector(\"video[id]\");\r\n                if (video) {\r\n                    clearInterval(_this.timer);\r\n                    _this.video = video;\r\n                    _this.video.addEventListener(\"loadstart\", function () {\r\n                        _this.initVideo();\r\n                    });\r\n                    _this.video.addEventListener(\"ended\", function () {\r\n                        _this.callEvent(\"complete\");\r\n                    });\r\n                    _this.callEvent(\"load\");\r\n                    _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.log.Debug(\"视频加载完成\");\r\n                    resolve();\r\n                }\r\n            }, 500);\r\n        });\r\n    };\r\n    VideoTask.prototype.Stop = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            clearInterval(_this.timer);\r\n            _this.callEvent(\"stop\");\r\n            resolve();\r\n        });\r\n    };\r\n    VideoTask.prototype.initVideo = function () {\r\n        this.video.muted = _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.config.video_mute;\r\n        if (_App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.config.video_multiple > 1) {\r\n            this.video.playbackRate = _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.config.video_multiple;\r\n        }\r\n    };\r\n    VideoTask.prototype.Start = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _this.initVideo();\r\n            _this.video.play();\r\n            _this.timer = setInterval(function () {\r\n                _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.config.auto && _this.video.paused && _this.video.play();\r\n            }, 5000);\r\n            resolve();\r\n        });\r\n    };\r\n    return VideoTask;\r\n}(_App_internal_app_task__WEBPACK_IMPORTED_MODULE_0__[\"Task\"]));\r\n\r\nvar CourseTopicTask = /** @class */ (function (_super) {\r\n    __extends(CourseTopicTask, _super);\r\n    function CourseTopicTask(resp) {\r\n        var _this = _super.call(this) || this;\r\n        var info = \"\";\r\n        if (resp) {\r\n            info = Object(_App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_2__[\"substrex\"])(resp, \",{aid:\", \",\");\r\n        }\r\n        var prefix = \"\";\r\n        if (document.URL.indexOf(\"cid\") > 0) {\r\n            prefix = \"c-\";\r\n        }\r\n        _this.bank = new _App_internal_app_question__WEBPACK_IMPORTED_MODULE_4__[\"ToolsQuestionBankFacade\"](\"mooc163\", {\r\n            refer: document.URL,\r\n            id: prefix + CourseTopicTask.getid(),\r\n            info: info,\r\n        });\r\n        if (resp) {\r\n            _this.bank.CheckCourse();\r\n        }\r\n        return _this;\r\n    }\r\n    CourseTopicTask.getid = function () {\r\n        var id = document.URL.match(/(\\?id|cid)=(.*?)($|&)/);\r\n        if (!id) {\r\n            id = document.URL.match(/(&id)=(.*?)$/);\r\n        }\r\n        if (!id) {\r\n            return \"\";\r\n        }\r\n        return id[2];\r\n    };\r\n    CourseTopicTask.collegeAnswer = function (resp) {\r\n        var id = this.getid();\r\n        if (id == \"\") {\r\n            return;\r\n        }\r\n        var prefix = \"\";\r\n        if (document.URL.indexOf(\"cid\") > 0) {\r\n            prefix = \"c-\";\r\n        }\r\n        var bank = new _App_internal_app_question__WEBPACK_IMPORTED_MODULE_4__[\"ToolsQuestionBank\"](\"mooc163\", {\r\n            refer: document.URL,\r\n            id: prefix + id,\r\n        });\r\n        var answer = new Array();\r\n        var options;\r\n        options = resp.objectiveQList;\r\n        if (options == undefined) {\r\n            options = resp;\r\n        }\r\n        if (options == undefined) {\r\n            return;\r\n        }\r\n        //TODO:优化,太难看了\r\n        for (var i = 0; i < options.length; i++) {\r\n            var topic = options[i];\r\n            if (topic.type != 1 && topic.type != 2) {\r\n                if (topic.type == 3) {\r\n                    var tmpAnswer_1 = new _App_internal_app_question__WEBPACK_IMPORTED_MODULE_4__[\"PushAnswer\"]();\r\n                    tmpAnswer_1.topic = topic.title;\r\n                    tmpAnswer_1.type = 4;\r\n                    tmpAnswer_1.correct = new Array();\r\n                    if (!topic.stdAnswer) {\r\n                        continue;\r\n                    }\r\n                    tmpAnswer_1.correct.push({\r\n                        option: \"一\", content: topic.stdAnswer,\r\n                    });\r\n                    answer.push(tmpAnswer_1);\r\n                }\r\n                else if (topic.type == 4) {\r\n                    var tmpAnswer_2 = new _App_internal_app_question__WEBPACK_IMPORTED_MODULE_4__[\"PushAnswer\"]();\r\n                    tmpAnswer_2.topic = topic.title;\r\n                    tmpAnswer_2.type = 3;\r\n                    tmpAnswer_2.correct = new Array();\r\n                    if (!topic.optionDtos) {\r\n                        continue;\r\n                    }\r\n                    for (var n = 0; n < topic.optionDtos.length; n++) {\r\n                        if (topic.optionDtos[n].answer) {\r\n                            tmpAnswer_2.correct.push({\r\n                                option: \"正确\" == topic.optionDtos[n].content,\r\n                                content: \"正确\" == topic.optionDtos[n].content,\r\n                            });\r\n                            break;\r\n                        }\r\n                    }\r\n                    answer.push(tmpAnswer_2);\r\n                }\r\n                continue;\r\n            }\r\n            if (!topic.optionDtos) {\r\n                continue;\r\n            }\r\n            var option = new Array();\r\n            var correct = new Array();\r\n            var tmpAnswer = new _App_internal_app_question__WEBPACK_IMPORTED_MODULE_4__[\"PushAnswer\"]();\r\n            tmpAnswer.topic = topic.title;\r\n            tmpAnswer.type = topic.type;\r\n            for (var i_1 = 0; i_1 < topic.optionDtos.length; i_1++) {\r\n                var opt = { content: topic.optionDtos[i_1].content, option: String.fromCharCode(65 + i_1) };\r\n                if (topic.optionDtos[i_1].answer) {\r\n                    correct.push(opt);\r\n                }\r\n                option.push(opt);\r\n            }\r\n            if (correct.length <= 0) {\r\n                return;\r\n            }\r\n            tmpAnswer.correct = correct;\r\n            tmpAnswer.answers = option;\r\n            answer.push(tmpAnswer);\r\n        }\r\n        bank.Push(answer);\r\n    };\r\n    CourseTopicTask.prototype.Init = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            setTimeout(function () {\r\n                if (document.querySelector(\"#tools-search\")) {\r\n                    document.querySelector(\"#tools-search\").remove();\r\n                }\r\n                var search = Object(_App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_2__[\"createBtn\"])(\"搜索答案\", \"点击搜索答案\", \"cx-btn mooc163-search\", \"tools-search\");\r\n                var divel = document.querySelector(\".j-unitct .m-learnunitUI\");\r\n                if (!divel) {\r\n                    divel = document.querySelector(\".u-learn-moduletitle\");\r\n                }\r\n                _this.topic = new _App_mooc_course163_question__WEBPACK_IMPORTED_MODULE_3__[\"CourseTopic\"](document, _this.bank);\r\n                _this.topic.SetQueryQuestions(new _App_mooc_course163_question__WEBPACK_IMPORTED_MODULE_3__[\"CourseQueryAnswer\"]());\r\n                search.onclick = function () { return __awaiter(_this, void 0, void 0, function () {\r\n                    var ret;\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0:\r\n                                search.innerText = \"搜索中...\";\r\n                                return [4 /*yield*/, this.Start()];\r\n                            case 1:\r\n                                ret = _a.sent();\r\n                                search.innerText = Object(_App_internal_app_question__WEBPACK_IMPORTED_MODULE_4__[\"QuestionStatusString\"])(ret);\r\n                                return [2 /*return*/];\r\n                        }\r\n                    });\r\n                }); };\r\n                divel.insertBefore(search, divel.firstChild);\r\n                resolve();\r\n            }, 1000);\r\n        });\r\n    };\r\n    CourseTopicTask.prototype.Start = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) { return __awaiter(_this, void 0, void 0, function () {\r\n            var ret;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        Object(_App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_2__[\"protocolPrompt\"])(\"你正准备使用中国慕课的答题功能,相应的我们需要你的正确答案,同意之后插件将自动检索你的所有答案\\n* 本项选择不会影响你的正常使用(协议当前版本有效)\\n* 手动点击答题结果页面自动采集页面答案\\n\", \"course_answer_collect_v2\", \"我同意\");\r\n                        return [4 /*yield*/, this.topic.QueryAnswer()];\r\n                    case 1:\r\n                        ret = _a.sent();\r\n                        this.callEvent(\"complete\");\r\n                        resolve(ret);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        }); });\r\n    };\r\n    CourseTopicTask.prototype.Submit = function () {\r\n        return new Promise(function (resolve) {\r\n            var el = document.querySelector(\".submit.j-submit\");\r\n            if (el.style.display == \"none\") {\r\n                resolve();\r\n            }\r\n            el.click();\r\n            var t = setInterval(function () {\r\n                var el = document.querySelector(\".submit.j-replay\");\r\n                if (el && el.style.display != \"none\") {\r\n                    clearInterval(t);\r\n                    resolve();\r\n                }\r\n            }, 1000);\r\n        });\r\n    };\r\n    return CourseTopicTask;\r\n}(_App_internal_app_task__WEBPACK_IMPORTED_MODULE_0__[\"Task\"]));\r\n\r\nvar DiscussTask = /** @class */ (function (_super) {\r\n    __extends(DiscussTask, _super);\r\n    function DiscussTask(resp) {\r\n        var _this = _super.call(this) || this;\r\n        _this.list = resp;\r\n        return _this;\r\n    }\r\n    DiscussTask.prototype.isRepeat = function () {\r\n        return document.querySelector(\"a.unfollowed\") == undefined;\r\n    };\r\n    DiscussTask.prototype.Start = function () {\r\n        var _this = this;\r\n        if (!this.list && this.list.lenght <= 0) {\r\n            _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.log.Info(\"没有查询到记录,跳过\");\r\n            this.callEvent(\"complete\");\r\n            return;\r\n        }\r\n        if (this.isRepeat()) {\r\n            _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.log.Info(\"已经关注,跳过\");\r\n            this.callEvent(\"complete\");\r\n            return;\r\n        }\r\n        _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.log.Info(\"复读机开启,准备复读(回复当前本讨论)\");\r\n        return new Promise(function (resolve) {\r\n            var num = 0;\r\n            var timer = setInterval(function () {\r\n                try {\r\n                    var rand = _this.list[Object(_App_internal_utils_utils__WEBPACK_IMPORTED_MODULE_2__[\"randNumber\"])(0, _this.list.length - 1)];\r\n                    var el = document.querySelector(\"iframe[id*=ueditor_]\");\r\n                    _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].GlobalContext.UE.instants[\"ueditorInstant\" + el.id.substr(el.id.indexOf(\"_\") + 1)].setContent(rand.content);\r\n                }\r\n                catch (e) {\r\n                    if (num < 5) {\r\n                        return;\r\n                    }\r\n                    _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.log.Error(\"发生了错误,准备跳过\", e);\r\n                }\r\n                clearInterval(timer);\r\n                _this.callEvent(\"complete\");\r\n                resolve();\r\n            }, 1000);\r\n        });\r\n    };\r\n    DiscussTask.prototype.Submit = function () {\r\n        if (this.isRepeat()) {\r\n            return;\r\n        }\r\n        return new Promise(function (resolve) {\r\n            _App_internal_application__WEBPACK_IMPORTED_MODULE_1__[\"Application\"].App.log.Info(\"准备提交\");\r\n            var el = document.querySelector(\".u-btn-sm.u-btn-primary\");\r\n            if (!el) {\r\n                return resolve();\r\n            }\r\n            el.click();\r\n            setTimeout(function () {\r\n                resolve();\r\n            }, 2000);\r\n        });\r\n    };\r\n    return DiscussTask;\r\n}(_App_internal_app_task__WEBPACK_IMPORTED_MODULE_0__[\"Task\"]));\r\n\r\n\n\n//# sourceURL=webpack:///./src/mooc/course163/task.ts?");

/***/ }),

/***/ "./src/mooc/mooc.ts":
/*!**************************!*\
  !*** ./src/mooc/mooc.ts ***!
  \**************************/
/*! exports provided: mooc */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mooc\", function() { return mooc; });\n/* harmony import */ var _App_internal_application__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @App/internal/application */ \"./src/internal/application.ts\");\n\r\nvar mooc = /** @class */ (function () {\r\n    function mooc(moocFactory) {\r\n        this.moocFactory = moocFactory;\r\n    }\r\n    mooc.prototype.start = function () {\r\n        try {\r\n            var state = document.readyState;\r\n            _App_internal_application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Debug(\"Start document state:\", state);\r\n            var mooc_1 = this.moocFactory.CreateMooc();\r\n            if (mooc_1 != null) {\r\n                mooc_1.Start();\r\n            }\r\n        }\r\n        catch (e) {\r\n            _App_internal_application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Fatal(\"插件发生了一个致命错误:\", e);\r\n        }\r\n        //最小化警告\r\n        if (top == self) {\r\n            var isShow_1 = false;\r\n            document.addEventListener(\"visibilitychange\", function () {\r\n                if (document.hidden) {\r\n                    if (isShow_1) {\r\n                        return;\r\n                    }\r\n                    _App_internal_application__WEBPACK_IMPORTED_MODULE_0__[\"Application\"].App.log.Warn(\"请注意!最小化可能导致视频无法正常播放!允许切换窗口.\");\r\n                    isShow_1 = true;\r\n                }\r\n            });\r\n        }\r\n    };\r\n    return mooc;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack:///./src/mooc/mooc.ts?");

/***/ }),

/***/ "./src/tampermonkey/course163-pack.ts":
/*!********************************************!*\
  !*** ./src/tampermonkey/course163-pack.ts ***!
  \********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _App_internal_utils_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @App/internal/utils/config */ \"./src/internal/utils/config.ts\");\n/* harmony import */ var _App_internal_utils_log__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @App/internal/utils/log */ \"./src/internal/utils/log.ts\");\n/* harmony import */ var _App_internal_application__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @App/internal/application */ \"./src/internal/application.ts\");\n/* harmony import */ var _App_mooc_mooc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @App/mooc/mooc */ \"./src/mooc/mooc.ts\");\n/* harmony import */ var _App_mooc_course163_platform__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @App/mooc/course163/platform */ \"./src/mooc/course163/platform.ts\");\n\r\n\r\n\r\n\r\n\r\nvar logger;\r\nif (top == self) {\r\n    logger = new _App_internal_utils_log__WEBPACK_IMPORTED_MODULE_1__[\"PageLog\"]();\r\n}\r\nelse {\r\n    logger = new _App_internal_utils_log__WEBPACK_IMPORTED_MODULE_1__[\"ConsoleLog\"]();\r\n}\r\n_App_internal_application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"].GlobalContext = window.unsafeWindow;\r\nvar component = new Map().\r\n    set(\"config\", new _App_internal_utils_config__WEBPACK_IMPORTED_MODULE_0__[\"ChromeConfigItems\"](Object(_App_internal_utils_config__WEBPACK_IMPORTED_MODULE_0__[\"NewFrontendGetConfig\"])())).\r\n    set(\"logger\", logger);\r\n;\r\nvar app = new _App_internal_application__WEBPACK_IMPORTED_MODULE_2__[\"Application\"](_App_internal_application__WEBPACK_IMPORTED_MODULE_2__[\"Frontend\"], new _App_mooc_mooc__WEBPACK_IMPORTED_MODULE_3__[\"mooc\"](new _App_mooc_course163_platform__WEBPACK_IMPORTED_MODULE_4__[\"Course163Platform\"]()), component);\r\napp.run();\r\n\n\n//# sourceURL=webpack:///./src/tampermonkey/course163-pack.ts?");

/***/ }),

/***/ "./src/views/common.ts":
/*!*****************************!*\
  !*** ./src/views/common.ts ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("window.addEventListener(\"load\", function () {\r\n    var css = \"#cxtools {\\n    position: absolute;\\n    left: 250px;\\n    top: 2px;\\n    width: 200px;\\n    font-size: 0;\\n}\\n\\n.cx-btn {\\n    outline: none;\\n    border: 0;\\n    background: #7d9d35;\\n    color: #fff;\\n    border-radius: 4px;\\n    padding: 2px 8px;\\n    cursor: pointer;\\n    font-size: 12px;\\n    margin-left: 4px;\\n}\\n\\n.cx-btn:hover {\\n    box-shadow: 1px 1px 1px 1px #ccc;\\n}\\n\\n.zhs-tools-btn {\\n    color: #fff;\\n    background: #ff9d34;\\n    padding: 4px;\\n    display: inline-block;\\n    height: 24px;\\n    font-size: 14px;\\n    line-height: 24px;\\n    margin:0;\\n}\\n\\n.zhs-tools-btn:hover {\\n    background: #ff3838;\\n}\\n\\n.zhs-start-btn{\\n    background: #36ac36;\\n}\\n\\n.zhs-start-btn:hover{\\n    background: #3b8d3b;\\n}\\n\\n#zhs-ytbn {\\n    color: #fff;\\n    background: #e777ff;\\n}\\n\\n#zhs-ytbn:hover {\\n    background: #e7b7f1;\\n}\\n\\n.zhs-search-answer {\\n    border: 0;\\n    outline: none;\\n    padding: 4px;\\n}\\n\\n.zhs-search-answer:hover {\\n    opacity: .85;\\n}\\n\\n.mooc163-search{\\n    background-color: #60b900;\\n    display: block;\\n    margin: 0 auto;\\n}\\n\\n.tools-logger-panel{\\n    width: 360px;\\n    height: auto;\\n    max-height: 260px;\\n    color:#000;\\n    position: fixed;\\n    margin: 0 auto;\\n    display: block;\\n    font-size: 14px;\\n    border-radius: 4px;\\n    width: 340px;\\n    text-align: center;\\n    overflow: hidden;\\n    left:60px;\\n    z-index: 100000;\\n    top: 40px;\\n    background: rgba(256, 256, 256, 0.3);\\n    box-shadow: 0px 0px 5px #bbb;\\n    transition-property: opacity, background-color;\\n    transition: 200ms ease-in-out;\\n}\\n\\n.head {\\n    width: 100%;\\n    height: 25px;\\n}\\n\\n.head span{\\n    color:#000;\\n    float:left;\\n    font-weight: 550;\\n}\\n\\n.status {\\n    color: #67C23A;\\n    font-weight: 600;\\n}\\n\\n.tools-notice-content {\\n    width: 100%;\\n    height: 220px;\\n    border-top:0px;\\n    overflow-y: scroll;\\n    overflow-x: hidden;\\n}\\n\\n.tools-notice-content .log {\\n    height: 26px;\\n    width: auto;\\n    text-align: center;\\n    border: 1px solid #eee;\\n}\\n\\n.tools-notice-content .log p {\\n    margin: 0;\\n    color: #aaa;\\n    font-size: 11px;\\n    font-weight: 500;\\n    font-family: Arial, Helvetica, sans-serif;\\n    line-height: 26px;\\n}\\n\\n/* \\u6EDA\\u52A8\\u69FD */\\n::-webkit-scrollbar {\\n    width: 10px;\\n    height: 10px;\\n}\\n\\n::-webkit-scrollbar-track {\\n    border-radius: 3px;\\n    background: rgba(0, 0, 0, 0.06);\\n    -webkit-box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.08);\\n}\\n\\n/* \\u6EDA\\u52A8\\u6761\\u6ED1\\u5757 */\\n::-webkit-scrollbar-thumb {\\n    border-radius: 3px;\\n    background: rgba(0, 0, 0, 0.12);\\n    -webkit-box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);\\n}\\n\\n/* \\u590D\\u9009\\u6846 */\\n.switch {\\n    margin: 2px auto;\\n    display: inline-flex;\\n    align-items: center;\\n    width: auto;\\n}\\n.checkbox-input {\\n    display: none\\n}\\n.checkbox {\\n    -webkit-transition: background-color 0.3s;\\n    transition: background-color 0.3s;\\n    background-color: #fff;\\n    border: 1px solid #d7d7d7;\\n    border-radius: 50px;\\n    width: 16px;\\n    height: 16px;\\n    vertical-align:middle;\\n    margin: 0 5px;\\n}\\n.checkbox-input:checked+.checkbox {\\n    background-color: #409EFF;\\n}\\n.checkbox-input:checked+.checkbox:after {\\n    // content: \\\"\\u221A\\\";\\n    display: inline-block;\\n    height: 100%;\\n    width: 100%;\\n    color: #fff;\\n    text-align: center;\\n    line-height: 16px;\\n    font-size: 12px;\\n    box-shadow: 0 0 4px #409EFF;\\n}\\n\\n.tools-logger-panel:hover,\\n.tools-logger-panel:focus-within {\\n    background: rgba(256, 256, 256, 0.7);\\n}\\n\\n.tools-logger-panel:active {\\n    background-color: #E5E5E5;\\n}\\n\\n.tools-logger-panel > .close {\\n    margin: 2px;\\n}\\n\\n\";\r\n    var style = document.createElement(\"style\");\r\n    style.innerHTML = css;\r\n    document.body.appendChild(style);\r\n});\r\n\n\n//# sourceURL=webpack:///./src/views/common.ts?");

/***/ })

/******/ });
